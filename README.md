# IMG SHERLOCK

This project implements an image forgery technique for detecting image splicing and copy-move tampering. The method uses error level analysis (ELA) to detect areas of an image that may have been tampered. A convolutional neural network (CNN) is used to train a supervised model for classifying whether an image is authentic or tampered. The neural network is trained with patches of tampered images extracted along the edges of where the tampering occurs and randomly selected patches from authentic images. Images are preprocessed by performing ELA to focus on the detection of JPEG compression artifacts instead of image feature extraction. Experimental results indicate that this technique performs well in comparison to other techniques using ELA for image forensics. Error level analysis data is also used in a tampered region localization technique to indicate what parts of an image is possibly tampered. 

### Package Description

The datasets can be found here: forensics.idealtest.org. The models directory contain the classes for ELA and CNN. train_model.py is used to train the Keras models. test_model.py is used to test either images or videos. tp_patch_extractor.py is used to automate tampered patch extraction. Usage information for these three scripts can be found within the header comments. home.py is the Flask script for the web interface. The templates directory has the html file for the web interface. Web interface: Inputs: Choose file - input image file. Step size - the step size of the sliding window (default:128). Localization threshold - value between 1 and 255 (default: 3). Test - submit inputs for testing
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Outputs: Result - the classification of the image: Tampered or Authentic.Top left - input image. Top right - results from sliding window and probability of correct classification. Bottom left - Error Level Analysis image with global brightness adjustment. Bottom right - results of tampered region localization. 

